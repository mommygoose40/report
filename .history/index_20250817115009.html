<!DOCTYPE html>
<html>
<head>
    <title>錄音測試</title>
    <script src="https://static.line-scdn.net/liff/edge/versions/2.22.3/sdk.js"></script>
    <style>
        body { font-family: Arial; padding: 20px; text-align: center; }
        button { padding: 12px 24px; background: #06c755; color: white; border: none; border-radius: 8px; }
        #status { margin: 15px; color: #666; }
        audio { width: 100%; margin-top: 20px; display: none; }
    </style>
</head>
<body>
    <h1>錄音測試</h1>
    <button id="record-btn">開始錄音</button>
    <div id="status">請點擊按鈕開始錄音</div>
    <audio id="audio-playback" controls></audio>

    <script>
        // 替換成您的 LIFF ID
        const liffId = '2007934728-xN6aOL3D';

        liff.init({ liffId: liffId })
            .then(() => {
                if (!liff.isLoggedIn()) liff.login();
                setupRecording();
            })
            .catch(err => {
                document.getElementById('status').textContent = '初始化失敗: ' + err.message;
            });

        function setupRecording() {
            const recordBtn = document.getElementById('record-btn');
            const status = document.getElementById('status');
            const audioPlayer = document.getElementById('audio-playback');

            recordBtn.addEventListener('click', async () => {
                try {
                    status.textContent = "準備錄音中...";
                    
                    // 檢查是否支援錄音
                    if (typeof liff.recordAudio !== 'function') {
                        throw new Error("此環境不支援錄音功能");
                    }

                    // 呼叫錄音功能
                    const recording = await liff.recordAudio({
                        maxDuration: 30,
                        title: '錄音測試',
                        message: '請說些什麼',
                        language: 'zh-TW'
                    });

                    // 顯示結果
                    status.textContent = "錄音成功！";
                    audioPlayer.src = recording.url;
                    audioPlayer.style.display = 'block';

                } catch (err) {
                    status.textContent = "錯誤: " + err.message;
                    console.error(err);
                }
            });
        }
    </script>
</body>
</html>